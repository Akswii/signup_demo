<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./styling/chart.css" />
    <link rel="stylesheet" href="https://design.payex.com/v/2.0.1/styles/px.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/orgchart/2.1.3/css/jquery.orgchart.min.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <title>Signup</title>
</head>

<body>
    <header class="topbar">
        <a href="#" class="topbar-logo"></a>
    </header>
    <div class="container" style="height: calc(100vh - 70px)">
        <div class="row">
            <div class="col">
                <div class="steps mt-3">
                    <ol>
                        <li class="steps-completed">
                            <div class="material-icons steps-icon">check</div>
                            Firmaoppslag
                        </li>
                        <li class="steps-completed">
                            <div class="material-icons steps-icon">check</div>
                            Registrering
                        </li>
                        <li class="steps-ongoing">Kundekontroll</li>
                        <li>Signering</li>
                    </ol>
                    <div class="steps-responsive">
                        <div class="steps-responsive-text">Step 3</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row h-100">
            <div class="col">
                <section class="panel panel-default">
                    <header>
                        <h2 class="panel-title">Kundekontroll</h2>
                    </header>
                    <div class="panel-body w-100">
                        <p>
                            Hvitvaskingsloven krever at vi innhenter en del informasjon om våre kunder for å sikre at
                            våre tjenester ikke benyttes til hvitvasking eller terrorfinansiering.
                            Dette innbærer blant annet at vi må skaffe oss kunnskap om hvordan selskapet kontrolleres
                            og hvem som tjener penger på det.
                        </p>
                        <div>
                            <h3 class="text-brand">Reelle rettighetshavere</h3>
                            <p>
                                Med reell rettighetshaver menes en eier (fysisk person) som direkte eller indirekte
                                innehar 25% eller mer av eierandelene, kontrollen, kapitalen eller stemmerettene i
                                selskapet.
                            </p>
                            <form action="#">
                                <div class="form-group">
                                    <div class="radio">
                                        <input type="radio" id="radio-example-1" name="radio-example" />
                                        <label for="radio-example-1">Selskapet har ingen fysiske personer som direkte
                                            eller indirekte innehar 25% eller mer av eierandelene, kontrollen,
                                            kapitalen eller stemmerettene i selskapet</label>
                                    </div>
                                    <div class="radio">
                                        <input type="radio" id="radio-example-2" name="radio-example" />
                                        <label for="radio-example-2">Selskapet eies helt eller delvis av en eller flere
                                            fysiske eller juridiske personer</label>
                                    </div>
                                </div>
                                <button class="btn btn-primary" type="submit">Submit</button>
                            </form>
                        </div>
                        <div id="chart-container"></div>
                        <div>
                            <span class="radio-panel">
                                <input type="radio" name="chart-state" id="rd-view" value="view"><label for="rd-view">View</label>
                                <input type="radio" name="chart-state" id="rd-edit" value="edit" checked="true"><label
                                    for="rd-edit">Edit</label>
                            </span>
                            <label class="selected-node-group">selected node:</label>
                            <input type="text" id="selected-node" class="selected-node-group">
                            <label>new node:</label>
                            <ul id="new-nodelist">
                                <li><input type="text" class="new-node"></li>
                            </ul>
                            <span id="node-type-panel" class="radio-panel">
                                <input type="radio" name="node-type" id="rd-parent" value="parent"><label for="rd-parent">Parent(root)</label>
                                <input type="radio" name="node-type" id="rd-child" value="children"><label for="rd-child">Child</label>
                            </span>
                            <button type="button" id="btn-add-nodes">Add</button>
                            <button type="button" id="btn-delete-nodes">Delete</button>
                        </div>

                        <form>
                            <div class="row">
                                <div class="col-5">
                                    <div class="form-group">
                                        <label for="grid-first-name">First name</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="grid-first-name" placeholder="Enter your first name"
                                                autoComplete="given-name" />
                                        </div>
                                        <div class="help-block">Hope it is something cool</div>
                                    </div>
                                </div>
                                <div class="col-5">
                                    <div class="form-group">
                                        <label for="grid-last-name">Last name</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="grid-last-name" placeholder="Enter your last name"
                                                autoComplete="family-name" />
                                        </div>
                                        <div class="help-block">Most likely in your passport</div>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <div class="form-group">
                                        <br />
                                        <button type="submit" class="btn btn-primary">Search</button>
                                    </div>
                                </div>
                            </div>
                            <div class="radio">
                                <input type="radio" id="radio-example-4" name="radio-example" />
                                <label for="radio-example-4">Placeholder</label>
                            </div>
                            <div class="radio">
                                <input type="radio" id="radio-example-5" name="radio-example" checked />
                                <label for="radio-example-5">Placeholder</label>
                            </div>
                            <div class="radio">
                                <input type="radio" id="radio-example-6" name="radio-example" checked />
                                <label for="radio-example-6">Placeholder</label>
                            </div>
                        </form>
                    </div>
                </section>
            </div>
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type="text/javascript" src="./scripts/jquery.orgchart.js"></script>
        <script src="https://design.payex.com/v/2.0.1/scripts/px-script.js"></script>
        <script type="text/javascript">
            $(function () {
                var datascource = {
                    'name': 'Firmanavn',
                    'test': 'test',
                    'children': []
                    // [{
                    //         'name': 'Football'
                    //     },
                    //     {
                    //         'name': 'Basketball'
                    //     },
                    //     {
                    //         'name': 'Volleyball'
                    //     }
                    // ]
                };
                var getId = function () {
                    return (new Date().getTime()) * 1000 + Math.floor(Math.random() * 1001);
                };
                var oc = $('#chart-container').orgchart({
                    'data': datascource,
                    'chartClass': 'edit-state',
                    'exportButton': true,
                    'exportFilename': 'SportsChart',
                    'parentNodeSymbol': 'fa-th-large',
                    'createNode': function ($node, data) {
                        $node[0].id = getId();
                    }
                });
                oc.$chartContainer.on('click', '.node', function () {
                    var $this = $(this);
                    $('#selected-node').val($this.find('.title').text()).data('node', $this);
                });
                oc.$chartContainer.on('click', '.orgchart', function (event) {
                    if (!$(event.target).closest('.node').length) {
                        $('#selected-node').val('');
                    }
                });
                $('input[name="chart-state"]').on('click', function () {
                    $('.orgchart').toggleClass('edit-state', this.value !== 'view');
                    $('#edit-panel').toggleClass('edit-state', this.value === 'view');
                    if ($(this).val() === 'edit') {
                        $('.orgchart').find('tr').removeClass('hidden')
                            .find('td').removeClass('hidden')
                            .find('.node').removeClass('slide-up slide-down slide-right slide-left');
                    } else {
                        $('#btn-reset').trigger('click');
                    }
                });
                $('input[name="node-type"]').on('click', function () {
                    var $this = $(this);
                    if ($this.val() === 'parent') {
                        $('#edit-panel').addClass('edit-parent-node');
                        $('#new-nodelist').children(':gt(0)').remove();
                    } else {
                        $('#edit-panel').removeClass('edit-parent-node');
                    }
                });
                $('#btn-add-input').on('click', function () {
                    $('#new-nodelist').append('<li><input type="text" class="new-node"></li>');
                });
                $('#btn-remove-input').on('click', function () {
                    var inputs = $('#new-nodelist').children('li');
                    if (inputs.length > 1) {
                        inputs.last().remove();
                    }
                });
                $('#btn-add-nodes').on('click', function () {
                    var $chartContainer = $('#chart-container');
                    var nodeVals = [];
                    $('#new-nodelist').find('.new-node').each(function (index, item) {
                        var validVal = item.value.trim();
                        if (validVal.length) {
                            nodeVals.push(validVal);
                        }
                    });
                    var $node = $('#selected-node').data('node');
                    if (!nodeVals.length) {
                        alert('Please input value for new node');
                        return;
                    }
                    var nodeType = $('input[name="node-type"]:checked');
                    if (!nodeType.length) {
                        alert('Please select a node type');
                        return;
                    }
                    if (nodeType.val() !== 'parent' && !$('.orgchart').length) {
                        alert(
                            'Please creat the root node firstly when you want to build up the orgchart from the scratch'
                        );
                        return;
                    }
                    if (nodeType.val() !== 'parent' && !$node) {
                        alert('Please select one node in orgchart');
                        return;
                    }
                    if (nodeType.val() === 'parent') {
                        if (!$chartContainer.children('.orgchart').length) { // if the original chart has been deleted
                            oc = $chartContainer.orgchart({
                                'data': {
                                    'name': nodeVals[0],
                                },
                                'exportButton': true,
                                'exportFilename': 'SportsChart',
                                'parentNodeSymbol': 'fa-th-large',
                                'createNode': function ($node, data) {
                                    $node[0].id = getId();
                                }
                            });
                            oc.$chart.addClass('view-state');
                        } else {
                            oc.addParent($chartContainer.find('.node:first'), {
                                'name': nodeVals[0],
                                'id': getId()
                            });
                        }
                    } else if (nodeType.val() === 'siblings') {
                        if ($node[0].id === oc.$chart.find('.node:first')[0].id) {
                            alert('You are not allowed to directly add sibling nodes to root node');
                            return;
                        }
                        oc.addSiblings($node, nodeVals.map(function (item) {
                            return {
                                'name': item,
                                'relationship': '110',
                                'id': getId()
                            };
                        }));
                    } else {
                        var hasChild = $node.parent().attr('colspan') > 0 ? true : false;
                        if (!hasChild) {
                            var rel = nodeVals.length > 1 ? '110' : '100';
                            oc.addChildren($node, nodeVals.map(function (item) {
                                return {
                                    'name': item,
                                    'relationship': rel,
                                    'id': getId()
                                };
                            }));
                        } else {
                            oc.addSiblings($node.closest('tr').siblings('.nodes').find('.node:first'),
                                nodeVals.map(function (item) {
                                    return {
                                        'name': item,
                                        'relationship': '110',
                                        'id': getId()
                                    };
                                }));
                        }
                    }
                });
                $('#btn-delete-nodes').on('click', function () {
                    var $node = $('#selected-node').data('node');
                    if (!$node) {
                        alert('Please select one node in orgchart');
                        return;
                    } else if ($node[0] === $('.orgchart').find('.node:first')[0]) {
                        if (!window.confirm('Are you sure you want to delete the whole chart?')) {
                            return;
                        }
                    }
                    oc.removeNodes($node);
                    $('#selected-node').val('').data('node', null);
                });
                $('#btn-reset').on('click', function () {
                    $('.orgchart').find('.focused').removeClass('focused');
                    $('#selected-node').val('');
                    $('#new-nodelist').find('input:first').val('').parent().siblings().remove();
                    $('#node-type-panel').find('input').prop('checked', false);
                });
            });
        </script>
</body>

</html>